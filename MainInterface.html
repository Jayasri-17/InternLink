<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>InternLink | Unified Interface</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary-blue: #1a73e8;
      --dark-blue: #0d47a1;
      --light-blue: #e8f0fe;
      --accent-orange: #ff9800;
      --dark-orange: #f57c00;
      --white: #ffffff;
      --light-gray: #f5f5f5;
      --medium-gray: #dadce0;
      --text-dark: #202124;
      --text-light: #5f6368;
      --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      --transition: all 0.3s ease;
    }

    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--light-gray); color: var(--text-dark); }

    header { width: 100%; padding:12px 40px; display:flex; justify-content:space-between; align-items:center; position:fixed; top:0; left:0; background-color: var(--white); box-shadow:0 2px 10px rgba(0,0,0,0.08); z-index:1000; }
    .logo { display:flex; align-items:center; gap:10px; font-size:24px; font-weight:700; color: var(--primary-blue);}
    .logo span { color: var(--accent-orange);}
    .search-bar { flex-grow:1; display:flex; justify-content:center; margin:0 40px; }
    .search-bar input { width:600px; height:44px; border:1px solid var(--medium-gray); border-radius:22px; padding:0 20px; font-size:15px; background-color: var(--light-gray);}
    .search-bar input:focus { outline:none; border-color: var(--primary-blue); box-shadow: 0 0 0 2px rgba(26,115,232,0.2); background-color: var(--white); }

    .navbar { width:100%; background-color: var(--white); box-shadow:0 2px 8px rgba(0,0,0,0.05); position:fixed; top:72px; left:0; z-index:999; padding:10px 40px; }
    .navbar ul { list-style:none; display:flex; justify-content:center; gap:40px; }
    .nav-item { font-weight:500; color: var(--text-light); cursor:pointer; display:flex; align-items:center; gap:8px; font-size:16px; transition: var(--transition);}
    .nav-item.active { color: var(--primary-blue); border-bottom:2px solid var(--primary-blue); padding-bottom:4px; }
    .nav-item:hover { color: var(--primary-blue); transform:translateY(-2px); }

    .section { display:none; margin-top:160px; padding:40px; max-width:1200px; margin-left:auto; margin-right:auto; min-height:80vh; }
    .section.active { display:block; }

    .internship-grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(280px,1fr)); gap:20px; margin-top:20px; }
    .internship-card { background:white; border-radius:12px; box-shadow: var(--shadow); padding:20px; position:relative; transition: var(--transition); }
    .internship-card:hover { box-shadow:0 6px 20px rgba(26,115,232,0.15); transform:translateY(-3px); }
    .internship-card .btn-group { margin-top:15px; display:flex; gap:12px; }
    .internship-card button { background-color: var(--accent-orange); border:none; padding:10px 18px; border-radius:8px; color:white; font-weight:600; cursor:pointer; font-size:14px; transition:0.3s; }
    .internship-card button:hover { background-color: var(--dark-orange); }

    .card-menu { position:absolute; top:10px; right:12px; cursor:pointer; font-size:18px; color:var(--text-light); }
    .card-menu:hover { color: var(--text-dark); }

    .menu-dropdown { display:none; position:absolute; top:30px; right:0; background:white; border:1px solid var(--medium-gray); border-radius:8px; box-shadow: var(--shadow); overflow:hidden; z-index:100; }
    .menu-dropdown div { padding:10px 16px; cursor:pointer; transition: var(--transition); }
    .menu-dropdown div:hover { background-color: var(--light-gray); }

    .floating-buttons { position:fixed; bottom:30px; right:30px; display:flex; flex-direction:column; gap:15px; z-index:999; }
    .float-btn { width:60px; height:60px; border-radius:50%; background: linear-gradient(135deg,var(--primary-blue),var(--dark-blue)); color:white; font-size:24px; display:flex; align-items:center; justify-content:center; cursor:pointer; box-shadow:0 4px 12px rgba(26,115,232,0.3); transition: var(--transition);}
    .float-btn:hover { transform: scale(1.1); }
    .float-btn.chatbot { background: linear-gradient(135deg,var(--accent-orange),var(--dark-orange)); }

    .modal { display:none; position:fixed; z-index:2000; left:0; top:0; width:100%; height:100%; background-color: rgba(0,0,0,0.5);}
    .modal-content { background-color: var(--white); margin:5% auto; padding:30px; border-radius:16px; width:600px; max-width:90%; box-shadow:0 10px 30px rgba(0,0,0,0.2); animation: fadeIn 0.3s ease;}
    @keyframes fadeIn { from {opacity:0; transform:translateY(-10px);} to {opacity:1; transform:translateY(0);} }
    .modal-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; border-bottom:2px solid var(--light-blue); padding-bottom:10px;}
    .modal-title { font-size:22px; font-weight:600; color: var(--primary-blue); }
    .close-btn { font-size:24px; cursor:pointer; color: var(--text-light); }

    #uploadForm { display:grid; grid-template-columns:1fr 1fr; gap:20px; }
    #uploadForm label { font-weight:500; color: var(--text-dark); margin-bottom:6px; display:block; }
    #uploadForm input, #uploadForm textarea, #uploadForm select { padding:12px 14px; font-size:15px; border-radius:8px; border:1px solid var(--medium-gray); width:100%; }
    #uploadForm textarea { grid-column:span 2; resize:none; min-height:100px; }
    #uploadForm button { grid-column:span 2; background:linear-gradient(135deg,var(--primary-blue),var(--dark-blue)); color:white; border:none; padding:14px; border-radius:8px; font-size:16px; font-weight:600; cursor:pointer; }

    .profile-card { background: var(--white); border-radius: 16px; padding: 30px; max-width: 600px; margin: 20px auto; display: flex; align-items: center; gap: 30px; box-shadow: var(--shadow); }
    .profile-avatar { width: 100px; height: 100px; background: var(--light-blue); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 48px; color: var(--primary-blue); }
    .profile-info { font-size: 16px; line-height: 1.6; }
  </style>
</head>
<body>
  <header>
    <div class="logo">
      <div>Intern<span>Link</span></div>
    </div>
    <div class="search-bar">
      <input type="search" placeholder="ðŸ” Search internships, companies, or roles...">
    </div>
  </header>

  <nav class="navbar">
    <ul>
      <li class="nav-item active" data-section="main"><i class="fas fa-briefcase"></i> Main</li>
      <li class="nav-item" data-section="applied"><i class="fas fa-paper-plane"></i> Applied</li>
      <li class="nav-item" data-section="saved"><i class="fas fa-bookmark"></i> Saved</li>
      <li class="nav-item" data-section="profile"><i class="fas fa-user"></i> Profile</li>
    </ul>
  </nav>

  <div id="main" class="section active">
    <h2>Welcome to <span style="color:var(--primary-blue)">InternLink</span>!</h2>
    <p>Find internships, apply, and share opportunities!</p>
    <div class="internship-grid" id="mainList"></div>
  </div>

  <div id="applied" class="section">
    <h2>Your Applied Internships</h2>
    <div class="internship-grid" id="appliedList"></div>
  </div>

  <div id="saved" class="section">
    <h2>Saved Internships</h2>
    <div class="internship-grid" id="savedList"></div>
  </div>

  <div id="profile" class="section">
    <h2>Your Profile</h2>
    <div class="profile-card">
      <div class="profile-avatar"><i class="fas fa-user"></i></div>
      <div class="profile-info" id="profileDetails"></div>
    </div>
  </div>

  <div class="floating-buttons">
    <div class="float-btn" id="openModal"><i class="fas fa-plus"></i></div>
    <div class="float-btn chatbot"><i class="fas fa-robot"></i></div>
  </div>

  <!-- Upload Internship Modal -->
  <div id="uploadModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-title"><i class="fas fa-upload"></i> Share Internship</div>
        <span class="close-btn">&times;</span>
      </div>
      <form id="uploadForm">
        <div><label>Title</label><input type="text" id="title" required></div>
        <div><label>Company</label><input type="text" id="company" required></div>
        <div><label>Link</label><input type="url" id="link" required></div>
        <div>
          <label>Category</label>
          <select id="category" required>
            <option value="">Select</option>
            <option>ML Engineer</option>
            <option>Web Developer</option>
            <option>Data Scientist</option>
            <option>Marketing</option>
            <option>Business</option>
            <option>Other</option>
          </select>
        </div>
        <div>
          <label>Description</label>
          <textarea id="description" required></textarea>
        </div>
        <button type="submit">Post Internship</button>
      </form>
    </div>
  </div>

  <!-- Share Modal -->
  <div id="shareModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-title"><i class="fas fa-share-alt"></i> Share Internship</div>
        <span class="close-btn" id="closeShare">&times;</span>
      </div>
      <div style="text-align:center;">
        <input type="text" id="shareLink" readonly style="width:80%;padding:10px;border:1px solid var(--medium-gray);border-radius:8px;margin-bottom:15px;">
        <br>
        <button id="copyLinkBtn" style="padding:10px 20px;margin:5px;background:var(--primary-blue);color:white;border:none;border-radius:8px;cursor:pointer;">Copy Link</button>
        <button id="whatsappShare" style="padding:10px 20px;margin:5px;background:#25D366;color:white;border:none;border-radius:8px;cursor:pointer;"><i class="fab fa-whatsapp"></i> WhatsApp</button>
        <button id="instagramShare" style="padding:10px 20px;margin:5px;background:#C13584;color:white;border:none;border-radius:8px;cursor:pointer;"><i class="fab fa-instagram"></i> Instagram</button>
      </div>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBCGGeypdVLUnkjDV2p4kHuXB2pG5O6ZyM",
      authDomain: "smart-finance-bot-cc0ed.firebaseapp.com",
      projectId: "smart-finance-bot-cc0ed",
      storageBucket: "smart-finance-bot-cc0ed.appspot.com",
      messagingSenderId: "626989165311",
      appId: "1:626989165311:web:3bfad465c9decdebabfaca",
      measurementId: "G-E6V0D1W0XM"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
  </script>

  <!-- Main Script -->
  <script>
    document.addEventListener('DOMContentLoaded', function(){
      const navItems = document.querySelectorAll('.nav-item');
      const sections = document.querySelectorAll('.section');
      const modal = document.getElementById('uploadModal');
      const shareModal = document.getElementById('shareModal');
      const shareInput = document.getElementById('shareLink');
      const internshipGrid = document.getElementById('mainList');
      const savedList = document.getElementById('savedList');
      let internships = [];

      navItems.forEach(item => {
        item.addEventListener('click', () => {
          navItems.forEach(i => i.classList.remove('active'));
          item.classList.add('active');
          const target = item.getAttribute('data-section');
          sections.forEach(sec => sec.classList.remove('active'));
          document.getElementById(target).classList.add('active');

          // Load saved internships on tab switch
          if (target === 'saved') {
            loadSavedInternships();
          }
        });
      });

      const user = JSON.parse(localStorage.getItem('currentUser'));
      if(user){
        document.getElementById('profileDetails').innerHTML = `<strong>Name:</strong> ${user.name}<br><strong>Email:</strong> ${user.email}`;
      } else {
        window.location.href = 'Login-Signup.html';
      }

      document.getElementById('openModal').addEventListener('click', ()=> modal.style.display='block');
      modal.querySelector('.close-btn').addEventListener('click', ()=> modal.style.display='none');
      window.addEventListener('click', e => { if(e.target==modal) modal.style.display='none'; });
      document.getElementById('closeShare').addEventListener('click', ()=> shareModal.style.display='none');
      window.addEventListener('click', e => { if(e.target==shareModal) shareModal.style.display='none'; });

      function createCard(intern, id){
        const card = document.createElement('div');
        card.classList.add('internship-card');
        card.innerHTML = `
          <div class="card-menu">â‹®
            <div class="menu-dropdown">
              <div class="delete">Delete</div>
              <div class="share">Share</div>
            </div>
          </div>
          <h3>${intern.title}</h3>
          <p><strong>Company:</strong> ${intern.company}</p>
          <p><strong>Category:</strong> ${intern.category}</p>
          <p>${intern.description}</p>
          <div class="btn-group">
            <button class="applyBtn">Apply</button>
            <button class="saveBtn">Save</button>
          </div>
        `;

        const menu = card.querySelector('.menu-dropdown');
        card.querySelector('.card-menu').addEventListener('click', e=>{
          menu.style.display = menu.style.display==='block'?'none':'block';
          e.stopPropagation();
        });
        document.addEventListener('click', ()=> menu.style.display='none');

        menu.querySelector('.delete').addEventListener('click', async ()=>{
          await db.collection("internships").doc(id).delete();
          loadInternships();
        });

        menu.querySelector('.share').addEventListener('click', ()=>{
          shareInput.value = intern.link;
          shareModal.style.display = 'block';
        });

        card.querySelector('.applyBtn').addEventListener('click', ()=>{
          window.open(intern.link,'_blank');
        });

        card.querySelector('.saveBtn').addEventListener('click', ()=>{
          let saved = JSON.parse(localStorage.getItem('savedInternships')) || [];
          if (!saved.some(i => i.id === id)) {
            saved.push({ ...intern, id });
            localStorage.setItem('savedInternships', JSON.stringify(saved));
            alert("Internship saved!");
          } else {
            alert("Already saved!");
          }
        });

        return card;
      }

      async function loadInternships(){
        internshipGrid.innerHTML = '<p>Loading...</p>';
        const snapshot = await db.collection("internships").get();
        internships = snapshot.docs.map(doc => ({id: doc.id, ...doc.data()}));
        internshipGrid.innerHTML = '';
        internships.forEach(i => internshipGrid.appendChild(createCard(i, i.id)));
      }

      function loadSavedInternships(){
        savedList.innerHTML = '';
        const saved = JSON.parse(localStorage.getItem('savedInternships')) || [];
        if(saved.length === 0){
          savedList.innerHTML = '<p>No saved internships yet.</p>';
          return;
        }
        saved.forEach(i => savedList.appendChild(createCard(i, i.id)));
      }

      document.getElementById('uploadForm').addEventListener('submit', async function(e){
        e.preventDefault();
        const newIntern = {
          title: document.getElementById('title').value,
          company: document.getElementById('company').value,
          link: document.getElementById('link').value,
          category: document.getElementById('category').value,
          description: document.getElementById('description').value
        };
        await db.collection("internships").add(newIntern);
        alert("Internship added successfully!");
        modal.style.display = 'none';
        this.reset();
        loadInternships();
      });

      document.getElementById('copyLinkBtn').addEventListener('click', ()=>{
        shareInput.select();
        document.execCommand('copy');
        alert('Link copied to clipboard!');
      });

      document.getElementById('whatsappShare').addEventListener('click', ()=>{
        const url = encodeURIComponent(shareInput.value);
        const whatsappUrl = `https://api.whatsapp.com/send?text=${url}`;
        window.open(whatsappUrl, '_blank');
      });

      document.getElementById('instagramShare').addEventListener('click', ()=>{
        alert('Copy this link and post it on Instagram: ' + shareInput.value);
        window.open('https://www.instagram.com/', '_blank');
      });

      document.querySelector('.float-btn.chatbot').addEventListener('click', () => {
        window.open('http://localhost:8501/', '_blank');
      });

      loadInternships();
    });
  </script>
</body>
</html>
